# 2. 클래스를 이용한 실습 예제 확장(중요)



# 1) 뼈대, 애플리케이션 설계하기(준비물들)

- 당연히 iot 가상환경에 들어가기 activate iot

- books 앱 만들기

  - **`1. python manage.py startapp books` 로 앱을 생성**한다! 
  - book앱의 기본 파일 들이 생기게된다.

- mysite/setting.py  에서 

  **2. INSTALLED_APPS = [          여기 내가만들 book을 추가해준다** 

  ​						**'books'**

  **]**

  

- 어플리케이션 화면 에서 보여줄 html파일들
  - books/ templates /books 에
    - **3.**
    - **index.html**
    - **book_list.html**
    - **book_detail.html  을 구성해둔다!** 



- URL 설계 (이렇게 할것이다 구상도임)

| URL 명         | 적용할 Class명 | html명           |
| -------------- | -------------- | ---------------- |
| /books/        | BooksModelView | index.html       |
| /books/book/   | BookList       | book_list.html   |
| /books/book/3/ | BookDetail     | book_detail.html |



## 2) books/models.py를 구축한다 (진정한 뼈대, 함수 class 정의하기)

- books/models.py

```python
from django.db import models

class Book(models.Model):
	title = models.CharField(max_length=100)
	authors = models.ManyToManyField('Author')
	publisher = models.ForeignKey('Publisher')
	publication_date = models.DateField()

	def __str__(self):
		return self.title
	def __repr__(self):
		return self.title
    
    
class Author(models.Model):
	salutation = models.CharField(max_length=100)
	name = models.CharField(max_length=50)
	email = models.EmailField()
    
	def __str__(self):
		return self.name
	def __repr__(self):
		return self.name
    
class Publisher(models.Model):
	name = models.CharField(max_length=50)
	address = models.CharField(max_length=100)
	website = models.URLField()
    
	def __str__(self):
		return self.name
	def __repr__(self):
		return self.name
```



## 3) 위에서 만든 뼈대를 admin.py를 이용, django 홈페이지에 적용한다.

```python
from django.contrib import admin
from books.models import Book, Author, Publisher

admin.site.register(Book)
admin.site.register(Author)
admin.site.register(Publisher)
```

## 4) 데이터 베이스를 홈페이지에 반영한다.

명령창 :python manage.py makemigrations books

명령창 :python mange.py migrate

## 5) mysite/urls.py 에 내 앱의 url을 등록한다.

```python
urlpatterns = [
				path('books/', include('books.urls')), # 추가한다
]
```

## 6) html의 부모 템플릿을 만든다!

- 최상위 위치에 templates 디렉토리를 만든다.
- base.html  생성 : 전체 html의 형태 결정
- base_books.html  생성 : books 앱에서의 html을 결정함 (따로 설정안하면 base.html따라감)

- 블럭정의
  - title , sidebar , content 
- **mysite/setting.py** 에 경로 등록해줌 (**import os도 해줘야**함)

```python
import os
:
TEMPLATES = [
{
'BACKEND': 'django.template.backends.django.DjangoTemplates',
'DIRS': [os.path.join(BASE_DIR, 'templates')],  # 이 부분을 등록해줘야됨
'APP_DIRS': True,
    .
    .
    .}
```

이부분을 등록하면 이제 Template에서 프로그램이 자동으로 찾아씀.

- base_html 만들기

```html
<!DOCTYPE html>
<html lang="en">

<head>
    <title>{% block title %}My Amazing Site{% endblock %}</title>
</head>
                             <!--My Amazing Site는 디폴트값-->
<body>
    <div id="sidebar">
        {% block sidebar %}
        <ul>
            <li><a href="/">Project_Home</a></li>
            <li><a href="/admin/">Admin</a></li>
        </ul>
        {% endblock %}
        <br>
    </div>
    <div id="content">
        {% block content %}{% endblock %}  <!--이 블럭은 디폴트값이없음-->
    </div>
</body>

</html>
```

- base_book.html 만들기

```html
{% extends "base.html" %}  <!--부모를 상속 받겠다는 의미-->

{% block title %}Books Application Site{% endblock %} <!--부모 디폴트값 버리고 내꺼 쓰겠다.-->

{% block sidebar %}
{{ block.super }}<!--디폴트 살리겠다. 부모꺼 살림 super().xx()과 비슷한의미 즉 오버라이드의 개념이라고 생각해도 좋다-->
<ul>
	<li><a href="/books/">Books_Home</a></li>  <!--메뉴 추가-->
</ul>
{% endblock %}
```



## 7)  url.py / view.py / html 3 가지만 작성하면 된다.

- 이제 남은건 앞에서 만든 class들 :뼈대, html베이스을 이용